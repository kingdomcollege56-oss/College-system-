<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Kingdom College Portal</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-storage-compat.js"></script>

<style>

/* GENERAL */
body{
margin:0;
font-family:Arial;
background:#eef3f9;
}

/* HEADER */
header{
background:#0a3d62;
color:white;
padding:25px;
text-align:center;
}

/* HERO */
.hero{
background:#cce5ff;
padding:40px;
text-align:center;
}

/* PANELS */
.portal-box{
display:grid;
grid-template-columns:repeat(auto-fit,minmax(160px,1fr));
gap:15px;
margin-top:25px;
}

.portal-box button{
padding:15px;
border:none;
border-radius:8px;
color:white;
font-weight:bold;
cursor:pointer;
font-size:15px;
}

/* COLORS */
.student{background:#27ae60;}
.lecturer{background:#2980b9;}
.bursar{background:#f39c12;}
.counsellor{background:#8e44ad;}
.registrar{background:#16a085;}
.academic{background:#d35400;}
.rector{background:#c0392b;}

/* MODAL */
.modal{
display:none;
position:fixed;
top:0;
left:0;
width:100%;
height:100%;
background:rgba(0,0,0,0.7);
}

.modal-box{
background:white;
max-width:350px;
margin:100px auto;
padding:25px;
border-radius:10px;
}

.modal-box input,textarea{
width:100%;
padding:10px;
margin:6px 0;
}

.modal-box button{
width:100%;
padding:12px;
background:#1e3799;
color:white;
border:none;
cursor:pointer;
font-weight:bold;
}

.close{
float:right;
color:red;
cursor:pointer;
font-weight:bold;
}

#error{
color:red;
font-size:14px;
}

/* SECTIONS */
section{
margin:25px;
padding:20px;
background:white;
border-radius:10px;
box-shadow:0 0 5px #ccc;
}

.gallery{
display:grid;
grid-template-columns:repeat(auto-fit,minmax(150px,1fr));
gap:10px;
}

.gallery img{
width:100%;
height:130px;
object-fit:cover;
border-radius:5px;
}

/* FOOTER */
footer{
background:#0a3d62;
color:white;
text-align:center;
padding:15px;
margin-top:30px;
}

</style>
</head>

<body>

<header>
<h1>Kingdom College of Health & Allied Sciences</h1>
<p>Mbeya - Kyela | Lake Oil</p>
</header>


<!-- HOME -->
<div class="hero">

<h2>Login Panel</h2>

<div class="portal-box">

<button class="student" onclick="openLogin('student')">Student</button>
<button class="lecturer" onclick="openLogin('lecturer')">Lecturer</button>
<button class="bursar" onclick="openLogin('bursar')">Bursar</button>
<button class="counsellor" onclick="openLogin('counsellor')">Counsellor</button>
<button class="registrar" onclick="openLogin('registrar')">Registrar</button>
<button class="academic" onclick="openLogin('academic')">Academic Affairs</button>
<button class="rector" onclick="openLogin('rector')">Rector</button>

</div>

</div>


<!-- ANNOUNCEMENT -->
<section>
<h3>üì¢ Announcements</h3>
<p id="announce">Loading...</p>
</section>


<!-- COURSES -->
<section>
<h3>üìò Courses</h3>
<ul id="courses"></ul>
</section>


<!-- GALLERY -->
<section>
<h3>üñº Gallery</h3>
<div class="gallery" id="gallery"></div>
</section>


<!-- MAP -->
<section>
<h3>üìç Location</h3>
<p id="location"></p>

<iframe id="map" width="100%" height="250"></iframe>

</section>


<!-- CONTACT -->
<section>
<h3>‚òé Contact</h3>
<p id="contact"></p>
</section>


<!-- LOGIN MODAL -->
<div class="modal" id="loginModal">

<div class="modal-box">

<span class="close" onclick="closeLogin()">X</span>

<h3 id="loginTitle"></h3>

<input type="email" id="email" placeholder="Email">
<input type="password" id="password" placeholder="Password">

<button onclick="login()">Login</button>

<p id="error"></p>

</div>
</div>


<!-- RECTOR PANEL -->
<div class="modal" id="rectorPanel">

<div class="modal-box">

<span class="close" onclick="closeRector()">X</span>

<h3>üëë Rector Control Panel</h3>

<textarea id="annText" placeholder="Announcement"></textarea>

<input id="locText" placeholder="Location">

<input id="contactText" placeholder="Contact">

<input id="mapText" placeholder="Google Map Embed Link">

<input id="courseText" placeholder="Add Course">

<input type="file" id="imgFile">

<button onclick="saveData()">Save</button>

<p id="msg"></p>

</div>
</div>


<footer>
<p>¬© 2026 Kingdom College</p>
<p>Developed by Carina üíô</p>
</footer>


<script>

/* FIREBASE CONFIG */
const firebaseConfig = {
apiKey: "AIzaSyAcL_PjNww-ea6d33irNgWbn1EsBq4acTA",
authDomain: "collegeportal-app.firebaseapp.com",
databaseURL: "https://collegeportal-app-default-rtdb.firebaseio.com",
projectId: "collegeportal-app",
storageBucket: "collegeportal-app.appspot.com",
messagingSenderId: "266762331631",
appId: "1:266762331631:web:66ddfbde53d33086ac421a"
};

firebase.initializeApp(firebaseConfig);

const auth = firebase.auth();
const db = firebase.database();
const storage = firebase.storage();

let selectedRole="";


/* DEFAULT DATA */
const defaultLocation="Mbeya - Kyela njia panda ipinda nyuma ya Lake Oil";
const defaultContact="+255(0)785705151 , +255(0)735705151";


/* OPEN LOGIN */
function openLogin(role){

selectedRole=role;

loginModal.style.display="block";

loginTitle.innerText=role.toUpperCase()+" LOGIN";

error.innerText="";

}


/* CLOSE */
function closeLogin(){
loginModal.style.display="none";
}

function closeRector(){
rectorPanel.style.display="none";
}


/* LOGIN */
function login(){

let email=email.value;
let pass=password.value;

if(!email || !pass){
error.innerText="Fill all fields";
return;
}

auth.signInWithEmailAndPassword(email,pass)

.then(res=>{

const uid=res.user.uid;

db.ref("users/"+uid+"/role").once("value")

.then(s=>{

if(!s.exists()){
error.innerText="No role!";
auth.signOut();
return;
}

if(s.val()!=selectedRole){
error.innerText="Wrong panel!";
auth.signOut();
return;
}

/* SUCCESS */
closeLogin();

if(selectedRole=="rector"){
rectorPanel.style.display="block";
}else{
alert("Login Success: "+selectedRole);
}

});

})

.catch(e=>{
error.innerText=e.message;
});

}


/* SAVE BY RECTOR */
function saveData(){

db.ref("announcement").set(annText.value);

db.ref("location").set(locText.value||defaultLocation);

db.ref("contact").set(contactText.value||defaultContact);

db.ref("map").set(mapText.value);

if(courseText.value!=""){
db.ref("courses").push(courseText.value);
}

let file=imgFile.files[0];

if(file){

let ref=storage.ref("gallery/"+file.name);

ref.put(file).then(()=>{

ref.getDownloadURL().then(url=>{
db.ref("gallery").push(url);
});

});

}

msg.innerText="Saved Successfully ‚úî";

}


/* LOAD DATA */

db.ref("announcement").on("value",s=>{
announce.innerText=s.val()||"Karibu Kingdom College";
});

db.ref("location").on("value",s=>{
location.innerText=s.val()||defaultLocation;
});

db.ref("contact").on("value",s=>{
contact.innerText=s.val()||defaultContact;
});

db.ref("map").on("value",s=>{

map.src=s.val()||
"https://www.google.com/maps?q=Kyela+Lake+Oil&output=embed";

});


db.ref("courses").on("child_added",s=>{

let li=document.createElement("li");
li.innerText=s.val();
courses.appendChild(li);

});


db.ref("gallery").on("child_added",s=>{

let img=document.createElement("img");
img.src=s.val();
gallery.appendChild(img);

});

</script>

</body>
</html>

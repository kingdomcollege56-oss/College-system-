<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Kingdom College Portal</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-storage-compat.js"></script>

<style>

/* GENERAL */
body{
margin:0;
font-family:Arial;
background:#f4f6fb;
}

/* HEADER */
header{
background:#0a3d62;
color:white;
padding:25px;
text-align:center;
}

/* SECTIONS */
.section{
background:white;
margin:20px;
padding:20px;
border-radius:10px;
box-shadow:0 0 5px rgba(0,0,0,0.1);
}

.section h2{
color:#0a3d62;
}

/* PANELS */
.portal-box{
display:grid;
grid-template-columns:repeat(auto-fit,minmax(160px,1fr));
gap:15px;
margin:20px;
}

.portal-box button{
padding:15px;
border:none;
border-radius:8px;
font-weight:bold;
cursor:pointer;
color:white;
font-size:15px;
}

/* PANEL COLORS */
.student{background:#27ae60;}
.lecturer{background:#2980b9;}
.bursar{background:#f39c12;}
.counsellor{background:#9b59b6;}
.registrar{background:#16a085;}
.rector{background:#c0392b;}
.academic{background:#34495e;}

/* MODAL */
.modal{
display:none;
position:fixed;
top:0;
left:0;
width:100%;
height:100%;
background:rgba(0,0,0,0.6);
}

.modal-box{
background:white;
max-width:350px;
margin:120px auto;
padding:25px;
border-radius:10px;
}

.modal-box input,textarea{
width:100%;
padding:10px;
margin:8px 0;
}

.modal-box button{
width:100%;
padding:12px;
background:#0a3d62;
color:white;
border:none;
cursor:pointer;
}

.close{
float:right;
color:red;
cursor:pointer;
}

#msg{color:green;}
#error{color:red;}

/* IMAGES */
.gallery img{
width:100%;
max-width:200px;
margin:5px;
border-radius:5px;
}

/* FOOTER */
footer{
background:#0a3d62;
color:white;
text-align:center;
padding:15px;
}

</style>
</head>

<body>

<header>
<h1>Kingdom College Portal</h1>
<p>Education | Discipline | Success</p>
</header>


<!-- PANELS -->
<div class="portal-box">

<button class="student" onclick="openLogin('student')">ğŸ“ Student</button>
<button class="lecturer" onclick="openLogin('lecturer')">ğŸ“˜ Lecturer</button>
<button class="bursar" onclick="openLogin('bursar')">ğŸ’° Bursar</button>
<button class="counsellor" onclick="openLogin('counsellor')">ğŸ§  Counsellor</button>
<button class="registrar" onclick="openLogin('registrar')">ğŸ“‚ Registrar</button>
<button class="academic" onclick="openLogin('academic')">ğŸ“š Academic Affairs</button>
<button class="rector" onclick="openLogin('rector')">ğŸ‘‘ Rector</button>

</div>


<!-- ANNOUNCEMENT -->
<div class="section">
<h2>ğŸ“¢ Announcements</h2>
<p id="announce">Loading...</p>
</div>


<!-- COURSES -->
<div class="section">
<h2>ğŸ“š Available Courses</h2>
<ul id="courses"></ul>
</div>


<!-- LOCATION -->
<div class="section">
<h2>ğŸ“ Location</h2>
<p id="location"></p>

<iframe id="map" width="100%" height="250" style="border:0"></iframe>
</div>


<!-- CONTACT -->
<div class="section">
<h2>â˜ï¸ Contact</h2>
<p id="contact"></p>
</div>


<!-- GALLERY -->
<div class="section">
<h2>ğŸ–¼ï¸ Gallery</h2>
<div class="gallery" id="gallery"></div>
</div>


<!-- LOGIN -->
<div class="modal" id="loginModal">

<div class="modal-box">

<span class="close" onclick="closeLogin()">X</span>

<h3 id="loginTitle"></h3>

<input type="email" id="email" placeholder="Email">
<input type="password" id="password" placeholder="Password">

<button onclick="login()">Login</button>

<p id="error"></p>

</div>
</div>


<!-- RECTOR PANEL -->
<div class="modal" id="rectorPanel">

<div class="modal-box">

<span class="close" onclick="closeRector()">X</span>

<h3>ğŸ‘‘ Rector Control</h3>

<textarea id="annText" placeholder="Announcement"></textarea>

<input id="courseText" placeholder="Add Course">

<input id="locText" placeholder="Location">

<input id="mapText" placeholder="Google Map Link">

<input id="contactText" placeholder="Contact">

<input type="file" id="imgFile">

<button onclick="saveData()">Save</button>

<p id="msg"></p>

</div>
</div>


<footer>
<p>Â© 2026 Kingdom College | By Carina ğŸ’™</p>
</footer>


<script>

/* FIREBASE */
const firebaseConfig = {
  apiKey: "AIzaSyAcL_PjNww-ea6d33irNgWbn1EsBq4acTA",
  authDomain: "collegeportal-app.firebaseapp.com",
  databaseURL: "https://collegeportal-app-default-rtdb.firebaseio.com",
  projectId: "collegeportal-app",
  storageBucket: "collegeportal-app.firebasestorage.app",
  messagingSenderId: "266762331631",
  appId: "1:266762331631:web:66ddfbde53d33086ac421a"
};

firebase.initializeApp(firebaseConfig);

const auth = firebase.auth();
const db = firebase.database();
const storage = firebase.storage();

let selectedRole="";


/* OPEN LOGIN */
function openLogin(role){

selectedRole=role;

document.getElementById("loginModal").style.display="block";

document.getElementById("loginTitle").innerText=
role.toUpperCase()+" LOGIN";

document.getElementById("error").innerText="";
}


/* CLOSE */
function closeLogin(){
document.getElementById("loginModal").style.display="none";
}

function closeRector(){
document.getElementById("rectorPanel").style.display="none";
}


/* LOGIN */
function login(){

const email=email.value;
const pass=password.value;

auth.signInWithEmailAndPassword(email,pass)

.then(res=>{

const uid=res.user.uid;

db.ref("users/"+uid+"/role").once("value")

.then(snap=>{

if(snap.val()!=selectedRole){
alert("Wrong Panel!");
auth.signOut();
return;
}

closeLogin();

if(selectedRole=="rector"){
document.getElementById("rectorPanel").style.display="block";
}

});

})

.catch(e=>{
error.innerText=e.message;
});
}


/* SAVE BY RECTOR */
function saveData(){

db.ref("announcement").set(annText.value);
db.ref("location").set(locText.value);
db.ref("map").set(mapText.value);
db.ref("contact").set(contactText.value);

if(courseText.value!=""){
db.ref("courses").push(courseText.value);
}

/* IMAGE */
const file=imgFile.files[0];

if(file){

const ref=storage.ref("gallery/"+file.name);

ref.put(file).then(()=>{

ref.getDownloadURL().then(url=>{

db.ref("gallery").push(url);

});

});
}

msg.innerText="Saved Successfully!";
}


/* LOAD DATA */
db.ref("announcement").on("value",s=>{
announce.innerText=s.val()||"No Announcement";
});

db.ref("location").on("value",s=>{
location.innerText=s.val()||"";
});

db.ref("contact").on("value",s=>{
contact.innerText=s.val()||"";
});

db.ref("map").on("value",s=>{
if(s.val()) map.src=s.val();
});

db.ref("courses").on("child_added",s=>{
let li=document.createElement("li");
li.innerText=s.val();
courses.appendChild(li);
});

db.ref("gallery").on("child_added",s=>{
let img=document.createElement("img");
img.src=s.val();
gallery.appendChild(img);
});

</script>

</body>
</html>

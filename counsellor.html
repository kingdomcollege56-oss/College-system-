<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Kingdom College Counsellor Panel</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{font-family:Arial;margin:0;background:#f2f2f2;}
header{background:#0a3d62;color:white;padding:15px;text-align:center;}
.container{max-width:1200px;margin:auto;padding:15px;}
.menu{display:flex;flex-wrap:wrap;gap:5px;justify-content:center;margin-bottom:10px;}
.menu button{padding:10px;border:none;background:#1e3799;color:white;border-radius:5px;cursor:pointer;}
.menu button:hover{background:#4a69bd;}
.subsection{display:none;background:white;padding:15px;border-radius:8px;box-shadow:0 0 5px gray;margin-bottom:15px;}
.card{border:1px solid #ccc;padding:10px;border-radius:5px;margin:8px 0;}
input,textarea,select,button{width:100%;padding:8px;margin:5px 0;}
.logout{background:red;}
</style>
</head>
<body>

<header>
<h2>Kingdom College Counsellor Panel</h2>
<p id="counsellorName"></p>
</header>

<div class="container">

<!-- LOGIN SECTION -->
<div id="loginSection" class="subsection" style="display:block;">
<h3>Login</h3>
<input id="cUsername" placeholder="Username">
<input id="cPassword" type="password" placeholder="Password">
<button onclick="cLogin()">Login</button>
<p id="loginMsg" style="color:red;"></p>
</div>

<!-- DASHBOARD SECTION -->
<div id="dashboard" style="display:none;">
<div class="menu">
<button onclick="openSubsection('messagesPanel')">Messages</button>
<button onclick="openSubsection('transfersPanel')">Transfer Requests</button>
<button onclick="openSubsection('announcementsPanel')">Announcements</button>
<button onclick="logout()" class="logout">Logout</button>
</div>

<!-- MESSAGES -->
<div id="messagesPanel" class="subsection">
<h3>Anonymous Messages</h3>
<div id="msgList"></div>
<textarea id="replyText" placeholder="Type reply..."></textarea>
<input id="replyStudent" type="hidden">
<button onclick="sendReply()">Send Reply</button>
</div>

<!-- TRANSFER REQUESTS -->
<div id="transfersPanel" class="subsection">
<h3>Transfer Requests</h3>
<div id="transferList"></div>
</div>

<!-- ANNOUNCEMENTS -->
<div id="announcementsPanel" class="subsection">
<h3>Post Announcement</h3>
<input id="annTitle" placeholder="Title">
<textarea id="annMessage" placeholder="Message"></textarea>
<button onclick="postAnnouncement()">Post</button>
<div id="annList"></div>
</div>

</div>

<footer style="text-align:center;padding:10px;">
Â© 2026 Kingdom College | By Carina
</footer>

<script>
// --- Dummy Data ---
const counsellorAccount = {username:"counsellor", password:"secure123"};
let messages = [
  {student:"student1@example.com", text:"I need help with registration", date:"2026-02-20", replies:[]},
  {student:"student2@example.com", text:"Transfer request question", date:"2026-02-19", replies:[]}
];
let transfers = [
  {student:"student1@example.com", currentCourse:"Biology", currentLevel:2, currentSemester:1, requestedCourse:"Chemistry", requestedLevel:2, requestedSemester:1, requestedInstitution:"Kingdom College", reason:"Change of interest", date:"2026-02-18", status:"Pending"},
  {student:"student2@example.com", currentCourse:"Physics", currentLevel:1, currentSemester:2, requestedCourse:"Math", requestedLevel:1, requestedSemester:2, requestedInstitution:"Kingdom College", reason:"Better program", date:"2026-02-19", status:"Pending"}
];
let announcements = [
  {title:"Welcome Students", message:"Semester begins next Monday", teacher:"Counsellor", date:"2026-02-15"}
];

// --- LOGIN FUNCTION ---
function cLogin(){
 let u = document.getElementById("cUsername").value.trim();
 let p = document.getElementById("cPassword").value.trim();
 if(u===counsellorAccount.username && p===counsellorAccount.password){
   localStorage.setItem("counsellor","loggedin");
   showDashboard();
 } else {
   document.getElementById("loginMsg").innerText="Wrong credentials!";
 }
}

// Show dashboard
function showDashboard(){
 document.getElementById("loginSection").style.display="none";
 document.getElementById("dashboard").style.display="block";
 document.getElementById("counsellorName").innerText = "Welcome Counsellor";
 openSubsection("messagesPanel");
 loadMessages();
 loadTransfers();
 loadAnnouncements();
}

// LOGOUT
function logout(){
 localStorage.removeItem("counsellor");
 location.reload();
}

// Check session
if(localStorage.getItem("counsellor")){
 showDashboard();
}

// --- Subsection navigation ---
function openSubsection(id){
 document.querySelectorAll(".subsection").forEach(s=>{
   if(s.id!=="loginSection") s.style.display="none";
 });
 document.getElementById(id).style.display="block";
}

// --- MESSAGES ---
function loadMessages(){
 const list = document.getElementById("msgList");
 list.innerHTML="";
 messages.forEach((m,i)=>{
   let div = document.createElement("div");
   div.className="card";
   div.innerHTML = `<b>From Student:</b> ${m.student}<br>${m.text}<br><i>${m.date}</i>
   <button onclick="prepareReply(${i})">Reply</button>`;
   if(m.replies.length>0){
     m.replies.forEach(r=>{
       div.innerHTML+=`<div style="margin-left:10px;color:green;"><b>Reply:</b> ${r.text} <i>${r.date}</i></div>`;
     });
   }
   list.appendChild(div);
 });
}

function prepareReply(index){
 document.getElementById("replyStudent").value=index;
 document.getElementById("replyText").value="";
}

function sendReply(){
 let index = document.getElementById("replyStudent").value;
 let text = document.getElementById("replyText").value.trim();
 if(text===""){ alert("Type reply"); return;}
 messages[index].replies.push({text:text, date:new Date().toLocaleString()});
 loadMessages();
 document.getElementById("replyText").value="";
}

// --- TRANSFERS ---
function loadTransfers(){
 const list = document.getElementById("transferList");
 list.innerHTML="";
 transfers.forEach((t,i)=>{
   let div = document.createElement("div");
   div.className="card";
   div.innerHTML=`<b>${t.student}</b><br>
   Current: ${t.currentCourse} L${t.currentLevel} S${t.currentSemester}<br>
   Requested: ${t.requestedCourse} L${t.requestedLevel} S${t.requestedSemester}<br>
   Institution: ${t.requestedInstitution}<br>
   Reason: ${t.reason}<br>
   Date: ${t.date}<br>
   Status: <span id="status_${i}">${t.status}</span>
   <button onclick="updateStatus(${i},'Approved')">Approve</button>
   <button onclick="updateStatus(${i},'Rejected')">Reject</button>`;
   list.appendChild(div);
 });
}

function updateStatus(i,status){
 transfers[i].status=status;
 loadTransfers();
}

// --- ANNOUNCEMENTS ---
function loadAnnouncements(){
 const list = document.getElementById("annList");
 list.innerHTML="";
 announcements.forEach(a=>{
   let div=document.createElement("div");
   div.className="card";
   div.innerHTML=`<b>${a.title}</b><br>${a.message}<br><i>Posted by: ${a.teacher} on ${a.date}</i>`;
   list.appendChild(div);
 });
}

function postAnnouncement(){
 let title=document.getElementById("annTitle").value.trim();
 let msg=document.getElementById("annMessage").value.trim();
 if(!title || !msg){ alert("Fill all fields"); return; }
 announcements.push({title:title,message:msg,teacher:"Counsellor",date:new Date().toLocaleString()});
 document.getElementById("annTitle").value="";
 document.getElementById("annMessage").value="";
 loadAnnouncements();
}
</script>

</body>
</html>

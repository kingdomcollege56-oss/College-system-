<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kingdom College Portal</title>
<style>
body{font-family:Arial,sans-serif;margin:0;background:#f2f2f2;}
header{background:#0a3d62;color:white;padding:15px;text-align:center;}
.container{max-width:1200px;margin:auto;padding:15px;}
.menu{display:flex;flex-wrap:wrap;gap:5px;justify-content:center;margin-bottom:10px;}
.menu button{padding:10px;border:none;background:#1e3799;color:white;border-radius:5px;cursor:pointer;}
.menu button:hover{background:#4a69bd;}
.subsection{display:none;background:white;padding:15px;border-radius:8px;box-shadow:0 0 5px gray;margin-bottom:15px;}
.card{border:1px solid #ccc;padding:10px;border-radius:5px;margin:8px 0;}
input,textarea,select,button{width:100%;padding:8px;margin:5px 0;}
.logout{background:red;}
h3{margin-top:0;}
footer{text-align:center;padding:10px;background:#0a3d62;color:white;margin-top:20px;}
</style>
</head>
<body>

<header>
<h2>Kingdom College Portal</h2>
<p id="userWelcome"></p>
</header>

<div class="container">

<!-- LOGIN/REGISTER SECTION -->
<div id="authSection" class="subsection" style="display:block;">
<h3>Login / Register</h3>
<select id="roleSelect">
<option value="student">Student</option>
<option value="lecturer">Lecturer</option>
<option value="counsellor">Counsellor</option>
</select>
<input id="userEmail" placeholder="Email/Username">
<input id="userPass" type="password" placeholder="Password">
<button onclick="loginUser()">Login</button>
<button onclick="registerUser()">Register (Student Only)</button>
<p id="authMsg" style="color:red;"></p>
</div>

<!-- DASHBOARD -->
<div id="dashboard" style="display:none;">

<!-- Dynamic Menu -->
<div class="menu" id="dashboardMenu"></div>

<!-- Student Panels -->
<div id="studentProfile" class="subsection">
<h3>Student Profile</h3>
<label>Name:</label><input id="stuName">
<label>Email:</label><input id="stuEmail" disabled>
<button onclick="saveStudentProfile()">Save Profile</button>
</div>

<div id="studentModules" class="subsection">
<h3>Module Registration</h3>
<select id="stuModuleSelect" multiple>
<option>Biochemistry 101</option>
<option>Anatomy 102</option>
<option>Physiology 103</option>
<option>Physics 101</option>
</select>
<button onclick="registerModules()">Register Modules</button>
<ul id="stuModuleList"></ul>
</div>

<div id="studentAssignments" class="subsection">
<h3>Submit Assignment</h3>
<label>Select Module:</label>
<select id="stuAssignModule"></select>
<label>File Name:</label><input id="stuAssignFile">
<button onclick="submitAssignment()">Submit</button>
<ul id="stuAssignmentList"></ul>
</div>

<div id="studentResults" class="subsection">
<h3>Results</h3>
<ul id="stuResultsList"></ul>
</div>

<div id="studentMaterials" class="subsection">
<h3>Materials</h3>
<ul id="stuMaterialsList"></ul>
</div>

<div id="studentTransfer" class="subsection">
<h3>Transfer Request</h3>
<label>From Course:</label><input id="tranCurrent">
<label>To Course:</label><input id="tranRequested">
<label>Reason:</label><input id="tranReason">
<button onclick="submitTransfer()">Submit Transfer</button>
<ul id="stuTransferList"></ul>
</div>

<div id="studentMessage" class="subsection">
<h3>Message Counsellor</h3>
<textarea id="stuMessageText" placeholder="Your message to counsellor (anonymous)"></textarea>
<button onclick="sendMessageToCounsellor()">Send Message</button>
</div>

<!-- Lecturer Panels -->
<div id="lecturerApprove" class="subsection">
<h3>Approve Student Modules</h3>
<ul id="lecturerPendingModules"></ul>
</div>

<div id="lecturerGrades" class="subsection">
<h3>Submit Grades</h3>
<label>Student Email:</label><input id="lecGradeEmail">
<label>Module:</label><select id="lecGradeModule"></select>
<label>Grade:</label><input id="lecGradeValue">
<button onclick="submitGrade()">Submit Grade</button>
</div>

<div id="lecturerMaterials" class="subsection">
<h3>Upload Materials</h3>
<label>Module:</label><select id="lecMaterialModule"></select>
<label>File Name:</label><input id="lecMaterialFile">
<button onclick="uploadMaterial()">Upload</button>
<ul id="lecMaterialList"></ul>
</div>

<div id="lecturerAssignments" class="subsection">
<h3>View Assignments</h3>
<ul id="lecAssignmentList"></ul>
</div>

<!-- Counsellor Panels -->
<div id="counsellorMessages" class="subsection">
<h3>Messages</h3>
<div id="counsellorMsgList"></div>
<textarea id="counsellorReplyText"></textarea>
<input type="hidden" id="counsellorReplyIndex">
<button onclick="counsellorSendReply()">Send Reply</button>
</div>

<div id="counsellorTransfers" class="subsection">
<h3>Transfer Requests</h3>
<ul id="counsellorTransferList"></ul>
</div>

<div id="counsellorAnnouncements" class="subsection">
<h3>Post Announcement</h3>
<input id="cAnnTitle" placeholder="Title">
<textarea id="cAnnMsg" placeholder="Message"></textarea>
<button onclick="postAnnouncement()">Post</button>
<ul id="cAnnList"></ul>
</div>

</div> <!-- dashboard -->

</div> <!-- container -->

<footer>Â© 2026 Kingdom College | By Carina</footer>

<script>
// --- Dummy Data ---
let students=[], lecturers=[{email:"lecturer@example.com",pass:"1234",name:"Dr. Smith"}];
let counsellor={username:"counsellor",password:"secure123"};
let currentUser=null; // {role,email,name}
let enrollments={}, assignments={}, results={}, materials=[], transfers=[], messages=[], announcements=[];

// --- AUTH FUNCTIONS ---
function loginUser(){
 const role=document.getElementById("roleSelect").value;
 const email=document.getElementById("userEmail").value.trim();
 const pass=document.getElementById("userPass").value.trim();
 if(role==="student"){
   let s=students.find(s=>s.email===email && s.pass===pass);
   if(s){currentUser={role:"student",email:email,name:s.name}; saveSession(); showDashboard();} 
   else{document.getElementById("authMsg").innerText="Student not found"; return;}
 } else if(role==="lecturer"){
   let l=lecturers.find(l=>l.email===email && l.pass===pass);
   if(l){currentUser={role:"lecturer",email:email,name:l.name}; saveSession(); showDashboard();} 
   else{document.getElementById("authMsg").innerText="Lecturer not found"; return;}
 } else if(role==="counsellor"){
   if(email===counsellor.username && pass===counsellor.password){
       currentUser={role:"counsellor",email:email,name:"Counsellor"}; saveSession(); showDashboard();
   } else{document.getElementById("authMsg").innerText="Counsellor wrong credentials"; return;}
 }
}

function registerUser(){
 const email=document.getElementById("userEmail").value.trim();
 const pass=document.getElementById("userPass").value.trim();
 const role=document.getElementById("roleSelect").value;
 if(role!=="student"){ alert("Only students can register"); return;}
 if(students.find(s=>s.email===email)){ alert("Email already registered"); return;}
 let name=email.split("@")[0];
 students.push({email:email,pass:pass,name:name});
 alert("Student registered! You can login now");
}

// --- SESSION ---
function saveSession(){ localStorage.setItem("collegeUser",JSON.stringify(currentUser)); }
function loadSession(){ 
 let u=JSON.parse(localStorage.getItem("collegeUser"));
 if(u){currentUser=u; showDashboard();}
}
function logout(){ currentUser=null; localStorage.removeItem("collegeUser"); location.reload(); }
loadSession();

// --- DASHBOARD MENU ---
function showDashboard(){
 document.getElementById("authSection").style.display="none";
 document.getElementById("dashboard").style.display="block";
 document.getElementById("userWelcome").innerText=`Welcome ${currentUser.name} (${currentUser.role})`;
 let menu=document.getElementById("dashboardMenu"); menu.innerHTML="";
 let panels=[];
 if(currentUser.role==="student"){ panels=["studentProfile","studentModules","studentAssignments","studentResults","studentMaterials","studentTransfer","studentMessage"]; }
 else if(currentUser.role==="lecturer"){ panels=["lecturerApprove","lecturerGrades","lecturerMaterials","lecturerAssignments"]; }
 else if(currentUser.role==="counsellor"){ panels=["counsellorMessages","counsellorTransfers","counsellorAnnouncements"]; }
 panels.forEach(p=>{ 
   let btn=document.createElement("button"); 
   btn.innerText=p.replace(/([A-Z])/g," $1").replace("student ","").replace("lecturer ","").replace("counsellor ",""); 
   btn.onclick=()=>openPanel(p); menu.appendChild(btn); 
 });
 openPanel(panels[0]);
 loadPanelData();
}

function openPanel(id){
 document.querySelectorAll(".subsection").forEach(s=>s.style.display="none");
 document.getElementById(id).style.display="block";
}

// --- DATA LOAD ---
function loadPanelData(){
 // Modules for student
 if(currentUser.role==="student"){
   document.getElementById("stuEmail").value=currentUser.email;
   updateStudentModulesList();
   updateAssignmentsList();
   updateResultsList();
   updateMaterialsList();
   updateTransfersList();
 }
 // Lecturer dropdowns
 if(currentUser.role==="lecturer"){
   updateLecturerModulesDropdowns();
   updateAssignmentsLecturer();
 }
 // Counsellor lists
 if(currentUser.role==="counsellor"){
   loadCounsellorMessages();
   loadCounsellorTransfers();
   loadAnnouncementsList();
 }
}

// --- STUDENT FUNCTIONS ---
function saveStudentProfile(){ 
 let s=students.find(st=>st.email===currentUser.email);
 s.name=document.getElementById("stuName").value; currentUser.name=s.name; saveSession(); alert("Profile saved"); showDashboard();
}
function registerModules(){
 let sel=document.getElementById("stuModuleSelect");
 let mods=[...sel.selectedOptions].map(o=>o.value);
 enrollments[currentUser.email]=mods; updateStudentModulesList(); alert("Modules registered!");
}
function updateStudentModulesList(){ 
 let ul=document.getElementById("stuModuleList"); ul.innerHTML="";
 let mods=enrollments[currentUser.email]||[];
 mods.forEach(m=>{ ul.innerHTML+=`<li>${m}</li>`; });
}
function submitAssignment(){ 
 let mod=document.getElementById("stuAssignModule").value;
 let file=document.getElementById("stuAssignFile").value;
 if(!assignments[currentUser.email]) assignments[currentUser.email]=[];
 assignments[currentUser.email].push({module:mod,file:file,status:"Submitted"});
 updateAssignmentsList(); alert("Assignment submitted!");
}
function updateAssignmentsList(){ 
 if(currentUser.role==="student"){
   let ul=document.getElementById("stuAssignmentList"); ul.innerHTML="";
   (assignments[currentUser.email]||[]).forEach(a=>{ ul.innerHTML+=`<li>${a.module}: ${a.file} (${a.status})</li>`; });
 }
 if(currentUser.role==="lecturer"){
   let ul=document.getElementById("lecAssignmentList"); ul.innerHTML="";
   for(let stu in assignments){
     assignments[stu].forEach(a=>{ ul.innerHTML+=`<li>${stu} - ${a.module}: ${a.file} (${a.status})</li>`; });
   }
 }
}
function updateResultsList(){ 
 let ul=document.getElementById("stuResultsList"); ul.innerHTML="";
 let res=results[currentUser.email]||[];
 res.forEach(r=>{ ul.innerHTML+=`<li>${r.module}: ${r.grade}</li>`; });
}
function updateMaterialsList(){ 
 let ul=document.getElementById("stuMaterialsList"); ul.innerHTML="";
 materials.forEach(m=>ul.innerHTML+=`<li>${m.module}: ${m.file}</li>`);
}
function submitTransfer(){ 
 transfers.push({student:currentUser.email,currentCourse:document.getElementById("tranCurrent").value,requestedCourse:document.getElementById("tranRequested").value,reason:document.getElementById("tranReason").value,status:"Pending"});
 updateTransfersList(); alert("Transfer request submitted!"); 
}
function updateTransfersList(){ 
 let ul=document.getElementById("stuTransferList"); ul.innerHTML="";
 transfers.filter(t=>t.student===currentUser.email).forEach(t=>{ ul.innerHTML+=`<li>${t.currentCourse} => ${t.requestedCourse} (${t.status})</li>`; });
}
function sendMessageToCounsellor(){ 
 let msg=document.getElementById("stuMessageText").value;
 messages.push({student:currentUser.email,text:msg,date:new Date().toLocaleString(),replies:[]});
 alert("Message sent!"); document.getElementById("stuMessageText").value="";
}

// --- LECTURER FUNCTIONS ---
function updateLecturerModulesDropdowns(){
 let mods=["Biochemistry 101","Anatomy 102","Physiology 103","Physics 101"];
 let sel=document.getElementById("lecGradeModule");
 let selMat=document.getElementById("lecMaterialModule");
 sel.innerHTML=""; selMat.innerHTML="";
 mods.forEach(m=>{ sel.innerHTML+=`<option>${m}</option>`; selMat.innerHTML+=`<option>${m}</option>`; });
 updatePendingModules();
 updateAssignmentsLecturer();
 updateMaterialsLecturer();
}
function updatePendingModules(){ 
 let ul=document.getElementById("lecturerPendingModules"); ul.innerHTML="";
 for(let stu in enrollments){
   enrollments[stu].forEach(m=>{ ul.innerHTML+=`<li>${stu} requested ${m} <button onclick="approveModule('${stu}','${m}')">Approve</button></li>`; });
 }
}
function approveModule(stu,mod){ alert(`${mod} for ${stu} approved!`); }
function submitGrade(){ 
 let stu=document.getElementById("lecGradeEmail").value;
 let mod=document.getElementById("lecGradeModule").value;
 let grade=document.getElementById("lecGradeValue").value;
 if(!results[stu]) results[stu]=[];
 results[stu].push({module:mod,grade:grade});
 alert("Grade submitted!"); updateResultsList();
}
function uploadMaterial(){ 
 let mod=document.getElementById("lecMaterialModule").value;
 let file=document.getElementById("lecMaterialFile").value;
 materials.push({module:mod,file:file}); updateMaterialsList(); updateMaterialsLecturer(); alert("Material uploaded!");
}
function updateMaterialsLecturer(){ 
 let ul=document.getElementById("lecMaterialList"); ul.innerHTML="";
 materials.forEach(m=>ul.innerHTML+=`<li>${m.module}: ${m.file}</li>`);
}
function updateAssignmentsLecturer(){ 
 let ul=document.getElementById("lecAssignmentList"); ul.innerHTML="";
 for(let stu in assignments){ assignments[stu].forEach(a=>{ ul.innerHTML+=`<li>${stu} - ${a.module}: ${a.file} (${a.status})</li>`; }); }
}

// --- COUNSELLOR FUNCTIONS ---
function loadCounsellorMessages(){ 
 let list=document.getElementById("counsellorMsgList"); list.innerHTML="";
 messages.forEach((m,i)=>{
   let div=document.createElement("div"); div.className="card";
   div.innerHTML=`<b>${m.student}</b>: ${m.text}<br><i>${m.date}</i><button onclick="prepareCounsellorReply(${i})">Reply</button>`;
   m.replies.forEach(r=>{ div.innerHTML+=`<div style="margin-left:10px;color:green;"><b>Reply:</b> ${r.text} <i>${r.date}</i></div>`; });
   list.appendChild(div);
 });
}
function prepareCounsellorReply(i){ document.getElementById("counsellorReplyIndex").value=i; document.getElementById("counsellorReplyText").value=""; }
function counsellorSendReply(){ 
 let i=document.getElementById("counsellorReplyIndex").value;
 let txt=document.getElementById("counsellorReplyText").value.trim();
 if(txt===""){ alert("Type reply"); return;}
 messages[i].replies.push({text:txt,date:new Date().toLocaleString()});
 loadCounsellorMessages(); document.getElementById("counsellorReplyText").value="";
}
function loadCounsellorTransfers(){ 
 let ul=document.getElementById("counsellorTransferList"); ul.innerHTML="";
 transfers.forEach((t,i)=>{ ul.innerHTML+=`<li>${t.student}: ${t.currentCourse} => ${t.requestedCourse} (${t.status}) <button onclick="updateTransferStatus(${i},'Approved')">Approve</button><button onclick="updateTransferStatus(${i},'Rejected')">Reject</button></li>`; });
}
function updateTransferStatus(i,status){ transfers[i].
